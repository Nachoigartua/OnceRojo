import{r as s,p as _,e as w,q as A,c as t,a as F,b as m,t as D,h as H,n as M,v as $,s as J,j as k,F as O,d as T,o as n}from"./index-Co-JfI1J.js";import{c as V,o as B}from"./horaArgentina-wJwX-x9z.js";const L={class:"contenedor"},x={class:"titulo"},K={key:0},U={key:1,class:"subtitulo"},G={key:2,class:"indicacion"},Q=["disabled"],W={key:4,class:"mensaje-error"},X={class:"pizarra"},Y={class:"dt-container"},Z=["onClick"],ee={key:5,class:"mensaje-reintento"},ne={__name:"El11Historico",setup(ae){const i=s({}),b=s([]),l=s({}),S=s(""),u=s(60),v=s(!1),P=s("formacion"),d=s(!1),h=s([]),c=s(""),I=s(""),z=_(()=>V());let g;const E=_(()=>{const e=Math.floor(u.value/60),a=u.value%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}`});function C(e){return typeof e!="string"?"":e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function y(e,a){return({"4-2-3-1":[["POR"],["DFI","DFC1","DFC2","DFD"],["MCD1","MCD2"],["EI","MCO","ED"],["DC"]],"4-3-3":[["POR"],["DFI","DFC1","DFC2","DFD"],["MC1","MC2","MC3"],["EI","DC","ED"]],"4-4-2":[["POR"],["DFI","DFC1","DFC2","DFD"],["MI","MC1","MC2","MD"],["DC1","DC2"]],"4-3-1-2":[["POR"],["DFI","DFC1","DFC2","DFD"],["MC1","MC2","MC3"],["MCO"],["DC1","DC2"]]}[e]||[]).map(o=>o.map(f=>{const j=a.find(q=>q.posicion===f);return j?j.posicion:f})).reverse()}w(async()=>{try{const e=B(),a=localStorage.getItem("ultimaPartida");if(a===e){d.value=!0;const o=await fetch("/OnceRojo/onceHistorico.json").then(f=>f.json());i.value=o[e],h.value=y(i.value.esquema,i.value.formacion),l.value=JSON.parse(localStorage.getItem("nombresAdivinados")||"{}"),c.value=localStorage.getItem("mensajeFinal")||"",v.value=localStorage.getItem("juegoFinalizado")==="true";return}a!==e&&(localStorage.removeItem("nombresAdivinados"),localStorage.removeItem("juegoFinalizado"),localStorage.removeItem("mensajeFinal"),localStorage.removeItem("tiempoRestante")),l.value=JSON.parse(localStorage.getItem("nombresAdivinados")||"{}"),v.value=localStorage.getItem("juegoFinalizado")==="true",c.value=localStorage.getItem("mensajeFinal")||"";const r=await fetch("/OnceRojo/onceHistorico.json").then(o=>o.json());if(!r||!r[e])throw new Error("Datos no disponibles");if(i.value=r[e],h.value=y(i.value.esquema,i.value.formacion),b.value=[...i.value.formacion.map(o=>({nombre:C(o.nombre),posicion:o.posicion})),{nombre:C(i.value.dt.nombre),posicion:"DT"}],v.value)return;const p=localStorage.getItem("tiempoRestante");p!==null?u.value=parseInt(p):(u.value=i.value.tiempo_limite||60,localStorage.setItem("tiempoRestante",u.value.toString())),localStorage.setItem("ultimaPartida",e),R()}catch(e){console.error(e),c.value="Error al cargar los datos."}});function N(){if(v.value)return;const e=C(S.value.trim());if(!e)return;const a=b.value.find(r=>{const p=C(r.nombre.split(" ").pop());return r.nombre===e||p===e});a&&!l.value[a.posicion]?(l.value[a.posicion]=a.nombre,S.value="",I.value="",localStorage.setItem("nombresAdivinados",JSON.stringify(l.value)),Object.keys(l.value).length===b.value.length&&(v.value=!0,localStorage.setItem("juegoFinalizado","true"),clearInterval(g),c.value="Correcto!",localStorage.setItem("mensajeFinal",c.value))):(I.value="Nombre incorrecto o ya ingresado.",setTimeout(()=>I.value="",3e3))}function R(){g&&clearInterval(g),g=setInterval(()=>{if(u.value>0)u.value--,localStorage.setItem("tiempoRestante",u.value.toString());else{clearInterval(g),v.value=!0,b.value.forEach(a=>{l.value[a.posicion]=a.nombre}),localStorage.setItem("nombresAdivinados",JSON.stringify(l.value)),c.value="Perdiste! La plantilla era:",localStorage.setItem("mensajeFinal",c.value);const e=new Date().toISOString().split("T")[0];localStorage.setItem("ultimaPartida",e),localStorage.setItem("juegoFinalizado","true")}},1e3)}return A(()=>{g&&clearInterval(g)}),(e,a)=>(n(),t("div",L,[F("h1",x,D(i.value.equipo||"Nombre del partido no disponible"),1),P.value==="formacion"?(n(),t("div",K,[v.value?(n(),t("div",{key:0,class:M(c.value.includes("Perdiste")?"mensaje-derrota":"mensaje-correcto")},[F("p",null,D(c.value),1)],2)):m("",!0),d.value?m("",!0):(n(),t("p",U,"Tiempo restante: "+D(E.value),1)),d.value?m("",!0):(n(),t("p",G,"Ingresá los nombres del 11 titular y el DT:")),d.value?m("",!0):H((n(),t("input",{key:3,"onUpdate:modelValue":a[0]||(a[0]=r=>S.value=r),onKeyup:J(N,["enter"]),class:"input-jugador",disabled:u.value.value<=0||v.value,placeholder:"Escribe un nombre de jugador o DT..."},null,40,Q)),[[$,S.value]]),I.value?(n(),t("p",W,D(I.value),1)):m("",!0),F("div",X,[F("div",Y,[k(D(l.value.DT||"DT")+" ",1),!l.value.DT&&!d.value?(n(),t("button",{key:0,class:"pista-boton",onClick:a[1]||(a[1]=r=>e.mostrarPista("DT"))}," 🔍 ")):m("",!0)]),(n(!0),t(O,null,T(h.value,(r,p)=>(n(),t("div",{class:"linea",key:p},[(n(!0),t(O,null,T(r,(o,f)=>(n(),t("div",{key:f,class:M(["jugador",{adivinado:l.value[o]}])},[k(D(l.value[o]||o)+" ",1),!l.value[o]&&!d.value?(n(),t("button",{key:0,class:"pista-boton",onClick:j=>e.mostrarPista(o)}," 🔍 ",8,Z)):m("",!0)],2))),128))]))),128))]),d.value?(n(),t("div",ee," Volvé a intentarlo en "+D(z.value)+" 🕛 ",1)):m("",!0)])):m("",!0)]))}};export{ne as default};
