import{r as l,p as P,e as R,q as V,c as i,a as v,b as h,t as f,h as q,v as x,s as A,j as z,F as N,d as w,o as u,n as H}from"./index-Bd_UDzU2.js";const B={class:"contenedor"},J={class:"titulo"},K={key:0},L={class:"subtitulo"},U=["disabled"],W={key:0,class:"mensaje-error"},Y={class:"pizarra"},G={class:"dt-container"},Q=["onClick"],X={key:1,class:"cartel-mensaje"},te={__name:"El11Historico",setup(Z){const d=l({}),y=l([]),s=l({}),D=l(""),c=l(60),p=l(!1),C=l("formacion"),T=l([]),S=l(""),g=l(!1),b=l("");let m;const O=P(()=>{const e=Math.floor(c.value/60),t=c.value%60;return`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`});function I(e){return typeof e!="string"?"":e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function E(e){const t=e.map(n=>n.posicion),a=t.filter(n=>n.startsWith("DF")).map(n=>n==="DFI"?"DFD":n==="DFD"?"DFI":n),r=t.filter(n=>n.startsWith("MC")),o=t.filter(n=>["EI","DC","ED"].includes(n)),j=t.filter(n=>n==="POR");return[o,r,a,j]}R(async()=>{try{const e=new Date().toISOString().split("T")[0],t=localStorage.getItem("ultimaPartida");s.value=JSON.parse(localStorage.getItem("nombresAdivinados")||"{}"),p.value=localStorage.getItem("juegoFinalizado")==="true";const a=await fetch("/OnceRojo/onceHistorico.json").then(o=>o.json());if(!a||!a[e])throw new Error("Datos no disponibles");if(d.value=a[e],T.value=E(d.value.formacion),y.value=[...d.value.formacion.map(o=>({nombre:I(o.nombre),posicion:o.posicion})),{nombre:I(d.value.dt.nombre),posicion:"DT"}],p.value){S.value=`🎮 Ya jugaste hoy
Vuelve a jugar en `+F(),g.value=!0;return}if(t===e){S.value=`🎮 Ya jugaste hoy
Vuelve a jugar en `+F(),g.value=!0;return}const r=localStorage.getItem("tiempoRestante");r!==null?c.value=parseInt(r):(c.value=d.value.tiempo_limite||60,localStorage.setItem("tiempoRestante",c.value.toString())),$()}catch(e){console.error(e),_("Error al cargar los datos.")}});function _(e){S.value=e,g.value=!0,setTimeout(()=>g.value=!1,5e3)}function M(){if(p.value)return;const e=I(D.value.trim());if(!e)return;const t=y.value.find(a=>{const r=I(a.nombre.split(" ").pop());return a.nombre===e||r===e});t&&!s.value[t.posicion]?(s.value[t.posicion]=t.nombre,D.value="",b.value="",localStorage.setItem("nombresAdivinados",JSON.stringify(s.value)),Object.keys(s.value).length===y.value.length&&(p.value=!0,localStorage.setItem("juegoFinalizado","true"),clearInterval(m),_("¡Felicidades! Has completado el 11 inicial."))):(b.value="Nombre incorrecto o ya ingresado.",setTimeout(()=>b.value="",3e3))}function $(){m&&clearInterval(m),m=setInterval(()=>{if(c.value>0)c.value--,localStorage.setItem("tiempoRestante",c.value.toString());else{clearInterval(m),p.value=!0;const e=new Date().toISOString().split("T")[0];localStorage.setItem("nombresAdivinados",JSON.stringify(s.value)),localStorage.setItem("ultimaPartida",e),localStorage.setItem("juegoFinalizado","true"),_("⏰ Se acabó el tiempo. Intenta mañana.")}},1e3)}V(()=>{m&&clearInterval(m)});function F(){const e=new Date,t=new Date(e);t.setHours(24,0,0,0);const a=t-e,r=Math.floor(a/36e5),o=Math.floor(a%36e5/6e4);return`${r}h ${o}m`}function k(e){let t="";if(e==="DT")t=d.value.dt.pista;else{const a=d.value.formacion.find(r=>r.posicion===e);t=(a==null?void 0:a.pista)||"Sin pista disponible."}_(t)}return(e,t)=>(u(),i("div",B,[v("h1",J,f(d.value.equipo||"Nombre del partido no disponible"),1),C.value==="formacion"?(u(),i("div",K,[v("p",L,"Tiempo restante: "+f(O.value),1),t[2]||(t[2]=v("p",{class:"indicacion"},"Ingresá los nombres del 11 titular y el DT:",-1)),q(v("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>D.value=a),onKeyup:A(M,["enter"]),class:"input-jugador",disabled:c.value.value<=0||p.value,placeholder:"Escribe un nombre de jugador o DT..."},null,40,U),[[x,D.value]]),b.value?(u(),i("p",W,f(b.value),1)):h("",!0),v("div",Y,[v("div",G,[z(f(s.value.DT||"DT")+" ",1),s.value.DT?h("",!0):(u(),i("button",{key:0,class:"pista-boton",onClick:t[1]||(t[1]=a=>k("DT"))}," 🔍 "))]),(u(!0),i(N,null,w(T.value,(a,r)=>(u(),i("div",{class:"linea",key:r},[(u(!0),i(N,null,w(a,(o,j)=>(u(),i("div",{key:j,class:H(["jugador",{adivinado:s.value[o]}])},[z(f(s.value[o]||o)+" ",1),s.value[o]?h("",!0):(u(),i("button",{key:0,class:"pista-boton",onClick:n=>k(o)}," 🔍 ",8,Q))],2))),128))]))),128))])])):h("",!0),g.value?(u(),i("div",X,[v("p",null,f(S.value),1)])):h("",!0)]))}};export{te as default};
