import{b as r,p as P,d as x,q as H,c as i,a as f,e as I,t as D,i as V,v as A,s as R,h as z,F as N,r as E,o as u,n as B}from"./index-DKNiXts5.js";const J={class:"contenedor"},G={class:"titulo"},K={key:0},L={class:"subtitulo"},U=["disabled"],W={key:0,class:"mensaje-error"},Q={class:"pizarra"},X={class:"dt-container"},Y=["onClick"],Z={key:1,class:"cartel-mensaje"},te={__name:"El11Historico",setup(ee){const c=r({}),S=r([]),o=r({}),y=r(""),v=r(60),w=r("formacion"),g=r(!1),F=r([]),T=r(""),b=r(!1),h=r("");let m;const C=P(()=>{const a=Math.floor(v.value/60),e=v.value%60;return`${String(a).padStart(2,"0")}:${String(e).padStart(2,"0")}`});function j(a){return typeof a!="string"?"":a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function O(a){const e=a.map(s=>s.posicion),t=e.filter(s=>s==="POR"),n=e.filter(s=>s.startsWith("DF")).map(s=>s==="DFI"?"DFD":s==="DFD"?"DFI":s),p=e.filter(s=>s.startsWith("MC"));return[e.filter(s=>["EI","DC","ED"].includes(s)),p,n,t]}x(async()=>{try{const a=localStorage.getItem("ultimaPartida"),t=new Date().toISOString().split("T")[0],l=JSON.parse(localStorage.getItem("nombresAdivinados")||"{}");o.value=l;const n=localStorage.getItem("juegoFinalizado")==="true",p=await fetch("/OnceRojo/onceHistorico.json").then(d=>d.json());if(!p||!p[t])throw new Error("Datos del equipo no disponibles para hoy.");if(c.value=p[t]||{equipo:"",dt:"",formacion:[],esquema:"4-3-3",tiempo_limite:60},F.value=O(c.value.formacion),n){g.value=!0,T.value="El juego ya ha finalizado.",b.value=!0;return}if(a===t){const d=q();T.value=`Vuelve a jugar en ${d}`,b.value=!0;return}v.value=c.value.tiempo_limite||60,S.value=[...c.value.formacion.map(d=>({nombre:j(d.nombre),posicion:d.posicion})),{nombre:j(c.value.dt),posicion:"DT"}],$()}catch(a){console.error("Error al cargar los datos:",a),_("Error al cargar los datos. Intenta nuevamente más tarde.")}});function _(a){T.value=a,b.value=!0,setTimeout(()=>{b.value=!1},5e3)}function M(){if(g.value)return;const a=j(y.value.trim());if(!a)return;const e=S.value.find(t=>{const l=t.nombre,n=j(t.nombre.split(" ").pop());return l===a||n===a});e&&!o.value[e.posicion]?(o.value[e.posicion]=e.nombre,y.value="",h.value="",localStorage.setItem("nombresAdivinados",JSON.stringify(o.value)),Object.keys(o.value).length===S.value.length&&(_("¡Felicidades! Has completado el 11 inicial."),g.value=!0,localStorage.setItem("juegoFinalizado","true"),clearInterval(m))):(h.value="Nombre incorrecto o ya ingresado.",setTimeout(()=>h.value="",3e3))}function $(){m&&clearInterval(m),m=setInterval(()=>{if(v.value--,v.value<=0){clearInterval(m),g.value=!0,localStorage.setItem("nombresAdivinados",JSON.stringify(o.value));const a=new Date().toISOString().split("T")[0];localStorage.setItem("ultimaPartida",a),Object.keys(o.value).length===S.value.length?_("¡Felicidades! Has completado el 11 inicial."):_("Se acabó el tiempo. Intenta nuevamente mañana.")}},1e3)}H(()=>{m&&clearInterval(m),v.value=60,g.value=!1,o.value={},b.value=!1,h.value="",y.value=""});function q(){const a=new Date,e=new Date(a);e.setHours(24,0,0,0);const t=e-a,l=Math.floor(t/(1e3*60*60)),n=Math.floor(t%(1e3*60*60)/(1e3*60));return`${l}h ${n}m`}function k(a){let e="";if(a==="DT")e=c.value.dt.pista;else{const t=c.value.formacion.find(l=>l.posicion===a);e=(t==null?void 0:t.pista)||"No hay pista disponible para esta posición."}_(e)}return(a,e)=>(u(),i("div",J,[f("h1",G,D(c.value.equipo||"Nombre del partido no disponible"),1),w.value==="formacion"?(u(),i("div",K,[f("p",L,"Tiempo restante: "+D(C.value),1),e[2]||(e[2]=f("p",{class:"indicacion"},"Ingresá los nombres del 11 titular y el DT:",-1)),V(f("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),onKeyup:R(M,["enter"]),class:"input-jugador",disabled:v.value.value<=0||g.value,placeholder:"Escribe un nombre de jugador o DT..."},null,40,U),[[A,y.value]]),h.value?(u(),i("p",W,D(h.value),1)):I("",!0),f("div",Q,[f("div",X,[z(D(o.value.DT||"DT")+" ",1),o.value.DT?I("",!0):(u(),i("button",{key:0,class:"pista-boton",onClick:e[1]||(e[1]=t=>k("DT"))}," 🔍 "))]),(u(!0),i(N,null,E(F.value,(t,l)=>(u(),i("div",{class:"linea",key:l},[(u(!0),i(N,null,E(t,(n,p)=>(u(),i("div",{key:p,class:B(["jugador",{adivinado:o.value[n]}])},[z(D(o.value[n]||n)+" ",1),o.value[n]?I("",!0):(u(),i("button",{key:0,class:"pista-boton",onClick:d=>k(n)}," 🔍 ",8,Y))],2))),128))]))),128))])])):I("",!0),b.value?(u(),i("div",Z,[f("p",null,D(T.value),1)])):I("",!0)]))}};export{te as default};
