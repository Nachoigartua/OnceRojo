import{r,p as P,e as V,q as H,c as l,a as v,b as D,t as f,h as q,v as x,s as A,j as N,F as w,d as z,o as i,n as B}from"./index-CWLAntZ9.js";const J={class:"contenedor"},R={class:"titulo"},K={key:0},L={class:"subtitulo"},U=["disabled"],W={key:0,class:"mensaje-error"},Y={class:"pizarra"},G={class:"dt-container"},Q=["onClick"],X={key:1,class:"cartel-mensaje"},ae={__name:"El11Historico",setup(Z){const c=r({}),y=r([]),s=r({}),_=r(""),m=r(60),p=r(!1),C=r("formacion"),T=r([]),S=r(""),g=r(!1),b=r("");let d;const O=P(()=>{const e=Math.floor(m.value/60),a=m.value%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}`});function I(e){return typeof e!="string"?"":e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function E(e){const a=e.map(n=>n.posicion),t=a.filter(n=>n.startsWith("DF")).map(n=>n==="DFI"?"DFD":n==="DFD"?"DFI":n),o=a.filter(n=>n.startsWith("MC")),u=a.filter(n=>["EI","DC","ED"].includes(n)),j=a.filter(n=>n==="POR");return[u,o,t,j]}V(async()=>{try{const e=new Date().toISOString().split("T")[0],a=localStorage.getItem("ultimaPartida");s.value=JSON.parse(localStorage.getItem("nombresAdivinados")||"{}"),p.value=localStorage.getItem("juegoFinalizado")==="true";const t=await fetch("/OnceRojo/onceHistorico.json").then(o=>o.json());if(!t||!t[e])throw new Error("Datos no disponibles");if(c.value=t[e],T.value=E(c.value.formacion),y.value=[...c.value.formacion.map(o=>({nombre:I(o.nombre),posicion:o.posicion})),{nombre:I(c.value.dt.nombre),posicion:"DT"}],p.value){S.value=`🎮 Ya jugaste hoy
Vuelve a jugar en `+k(),g.value=!0;return}if(a===e){S.value=`🎮 Ya jugaste hoy
Vuelve a jugar en `+k(),g.value=!0;return}m.value=c.value.tiempo_limite||60,$()}catch(e){console.error(e),h("Error al cargar los datos.")}});function h(e){S.value=e,g.value=!0,setTimeout(()=>g.value=!1,5e3)}function M(){if(p.value)return;const e=I(_.value.trim());if(!e)return;const a=y.value.find(t=>{const o=I(t.nombre.split(" ").pop());return t.nombre===e||o===e});a&&!s.value[a.posicion]?(s.value[a.posicion]=a.nombre,_.value="",b.value="",localStorage.setItem("nombresAdivinados",JSON.stringify(s.value)),Object.keys(s.value).length===y.value.length&&(p.value=!0,localStorage.setItem("juegoFinalizado","true"),clearInterval(d),h("¡Felicidades! Has completado el 11 inicial."))):(b.value="Nombre incorrecto o ya ingresado.",setTimeout(()=>b.value="",3e3))}function $(){d&&clearInterval(d),d=setInterval(()=>{if(m.value--,m.value<=0){clearInterval(d),p.value=!0;const e=new Date().toISOString().split("T")[0];localStorage.setItem("nombresAdivinados",JSON.stringify(s.value)),localStorage.setItem("ultimaPartida",e),Object.keys(s.value).length===y.value.length?h("¡Felicidades! Has completado el 11 inicial."):h("⏰ Se acabó el tiempo. Intenta mañana.")}},1e3)}H(()=>{d&&clearInterval(d)});function k(){const e=new Date,a=new Date(e);a.setHours(24,0,0,0);const t=a-e,o=Math.floor(t/36e5),u=Math.floor(t%36e5/6e4);return`${o}h ${u}m`}function F(e){let a="";if(e==="DT")a=c.value.dt.pista;else{const t=c.value.formacion.find(o=>o.posicion===e);a=(t==null?void 0:t.pista)||"Sin pista disponible."}h(a)}return(e,a)=>(i(),l("div",J,[v("h1",R,f(c.value.equipo||"Nombre del partido no disponible"),1),C.value==="formacion"?(i(),l("div",K,[v("p",L,"Tiempo restante: "+f(O.value),1),a[2]||(a[2]=v("p",{class:"indicacion"},"Ingresá los nombres del 11 titular y el DT:",-1)),q(v("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>_.value=t),onKeyup:A(M,["enter"]),class:"input-jugador",disabled:m.value.value<=0||p.value,placeholder:"Escribe un nombre de jugador o DT..."},null,40,U),[[x,_.value]]),b.value?(i(),l("p",W,f(b.value),1)):D("",!0),v("div",Y,[v("div",G,[N(f(s.value.DT||"DT")+" ",1),s.value.DT?D("",!0):(i(),l("button",{key:0,class:"pista-boton",onClick:a[1]||(a[1]=t=>F("DT"))}," 🔍 "))]),(i(!0),l(w,null,z(T.value,(t,o)=>(i(),l("div",{class:"linea",key:o},[(i(!0),l(w,null,z(t,(u,j)=>(i(),l("div",{key:j,class:B(["jugador",{adivinado:s.value[u]}])},[N(f(s.value[u]||u)+" ",1),s.value[u]?D("",!0):(i(),l("button",{key:0,class:"pista-boton",onClick:n=>F(u)}," 🔍 ",8,Q))],2))),128))]))),128))])])):D("",!0),g.value?(i(),l("div",X,[v("p",null,f(S.value),1)])):D("",!0)]))}};export{ae as default};
